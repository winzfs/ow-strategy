<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ë²„ì›Œì¹˜ í—ˆë¸Œ ì»¤ë®¤ë‹ˆí‹° - ììœ ê²Œì‹œíŒ & íŒŒí‹°ëª¨ì§‘ í›„ê¸°</title>
    <meta name="description" content="ì˜¤ë²„ì›Œì¹˜ ìœ ì €ë“¤ê³¼ ì†Œí†µí•˜ëŠ” ììœ  ê²Œì‹œíŒì…ë‹ˆë‹¤. íŒŒí‹° í›„ê¸°, íŒ ê³µìœ , ì§ˆë¬¸ ë‹µë³€ ë“± ë‹¤ì–‘í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ì–´ë³´ì„¸ìš”.">
    <meta name="keywords" content="ì˜¤ë²„ì›Œì¹˜ ì»¤ë®¤ë‹ˆí‹°, ì˜¤ë²„ì›Œì¹˜ ê²Œì‹œíŒ, ì˜¤ë²„ì›Œì¹˜ ììœ ê²Œì‹œíŒ, ì˜¤ë²„ì›Œì¹˜ íŒ, owhub ì»¤ë®¤ë‹ˆí‹°">
    <link rel="canonical" href="https://owhub.vercel.app/commu.html">

    <meta property="og:title" content="Overwatch Hub - ì»¤ë®¤ë‹ˆí‹°">
    <meta property="og:description" content="ì˜¤ë²„ì›Œì¹˜ ìš”ì›ë“¤ì˜ ì‹¤ì‹œê°„ ì†Œí†µ ê³µê°„!">
    <meta property="og:url" content="https://owhub.vercel.app/commu.html">
    <style>
        :root { --accent: #ff9c00; --bg-dark: #111; }
        body { background: var(--bg-dark); color: white; font-family: 'Pretendard', sans-serif; margin: 0; padding-bottom: 50px; }
        nav { background: #000; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 100; }
        .nav-tabs { display: flex; gap: 20px; align-items: center; }
        .nav-tabs a, .nav-tabs div { cursor: pointer; font-weight: 600; font-size: 14px; text-decoration: none; }
        .container { max-width: 800px; margin: 30px auto; padding: 0 15px; }
        .box { background: #1a1a1a; padding: 20px; border-radius: 12px; border: 1px solid #333; margin-bottom: 15px; position: relative; }
        .btn-main { background: var(--accent); color: black; border: none; padding: 12px; border-radius: 8px; font-weight: 700; cursor: pointer; width: 100%; margin-top: 10px; }
        .btn-sub { background: #333; color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; font-size: 12px; }
        input, textarea { background: #252525; border: 1px solid #333; color: white; padding: 10px; border-radius: 8px; width: 100%; box-sizing: border-box; margin-bottom: 8px; }
        .post-info { font-size: 12px; color: #888; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .author-name { color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>

<nav>
    <div class="nav-tabs">
        <a href="index.html" style="color:#888;">íŒŒí‹°ì°¾ê¸°</a>
        <div style="color:var(--accent); border-bottom: 2px solid var(--accent); padding-bottom: 2px;">ì»¤ë®¤ë‹ˆí‹°</div>
    </div>
    <div id="auth-ui">
        </div>
</nav>

<div class="container">
    <div class="box">
        <h4 style="margin:0 0 10px 0; color:var(--accent);">ğŸ’¬ ììœ ê²Œì‹œíŒ</h4>
        <input type="text" id="comm-title" placeholder="ì œëª©">
        <textarea id="comm-content" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš” (ë¹„ì†ì–´ ì‚¬ìš© ì‹œ ì œì¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤)" rows="4"></textarea>
        <button class="btn-main" id="btn-comm-post">ê¸€ ë“±ë¡</button>
    </div>
    <div id="comm-list"></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, doc, getDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = { 
        apiKey: "AIzaSyA96CFg3o1TpD5lu-0rYMlIp16Ev8URDuw", 
        authDomain: "ow-party-97936.firebaseapp.com", 
        projectId: "ow-party-97936", 
        storageBucket: "ow-party-97936.firebasestorage.app", 
        messagingSenderId: "15782204013", 
        appId: "1:15782204013:web:5c74ef2e603c311fc82564" 
    };
    
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    const ADMIN_EMAILS = ["jazzhjm@gmail.com", "jazzhjm@gmaol.com"];
    let myBtag = "ìµëª…";
    let unsubscribe = null;

    const timeSince = (date) => {
        const seconds = Math.floor((Date.now() - date) / 1000);
        if (seconds < 60) return "ë°©ê¸ˆ ì „";
        const mins = Math.floor(seconds / 60);
        if (mins < 60) return mins + "ë¶„ ì „";
        const hours = Math.floor(mins / 60);
        if (hours < 24) return hours + "ì‹œê°„ ì „";
        return Math.floor(hours / 24) + "ì¼ ì „";
    };

    // ë¡œê·¸ì¸ ìƒíƒœ ê°ì‹œ
    onAuthStateChanged(auth, async (user) => {
        const authUI = document.getElementById('auth-ui');
        if (user) {
            const userSnap = await getDoc(doc(db, "users", user.uid));
            if (userSnap.exists()) {
                myBtag = userSnap.data().btag || "ìµëª…";
            }
            authUI.innerHTML = `<button id="btn-logout" class="btn-sub">ë¡œê·¸ì•„ì›ƒ</button>`;
            document.getElementById('btn-logout').onclick = () => {
                signOut(auth).then(() => location.reload());
            };
        } else {
            myBtag = "ìµëª…";
            authUI.innerHTML = `<button onclick="location.href='index.html'" class="btn-sub">ë¡œê·¸ì¸</button>`;
        }
        // ë¡œê·¸ì¸ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ëª©ë¡ì€ í•­ìƒ ë¶ˆëŸ¬ì˜´
        startListing();
    });

    // ì‹¤ì‹œê°„ ëª©ë¡ ë Œë”ë§
    function startListing() {
        if (unsubscribe) unsubscribe();
        
        const q = query(collection(db, "community"), orderBy("createdAt", "desc"));
        unsubscribe = onSnapshot(q, (snap) => {
            const list = document.getElementById('comm-list');
            const currentUser = auth.currentUser;
            const isAdmin = currentUser && ADMIN_EMAILS.includes(currentUser.email);

            list.innerHTML = snap.docs.map(docSnap => {
                const d = docSnap.data();
                const isMine = currentUser && currentUser.uid === d.uid;
                
                return `
                    <div class="box">
                        <div class="post-info">
                            <span><span class="author-name">${d.author || 'ìµëª…'}</span> â€¢ ${timeSince(d.createdAt)}</span>
                            ${(isMine || isAdmin) ? `<button onclick="window.delCommPost('${docSnap.id}')" style="background:none; border:none; color:#ff3c3c; cursor:pointer; font-size:11px;">ì‚­ì œ</button>` : ''}
                        </div>
                        <h4 style="margin:5px 0 10px 0;">${d.title}</h4>
                        <p style="font-size:14px; color:#ccc; line-height:1.5; white-space:pre-wrap;">${d.content}</p>
                    </div>`;
            }).join('');
        });
    }

    // ê¸€ ë“±ë¡ ë¡œì§
    document.getElementById('btn-comm-post').onclick = async () => {
        const user = auth.currentUser;
        if (!user) {
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.");
            location.href = "index.html";
            return;
        }
        
        const title = document.getElementById('comm-title').value.trim();
        const content = document.getElementById('comm-content').value.trim();
        
        if(!title || !content) return alert("ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.");

        try {
            await addDoc(collection(db, "community"), {
                uid: user.uid,
                author: myBtag.split('#')[0],
                title: title,
                content: content,
                createdAt: Date.now()
            });
            document.getElementById('comm-title').value = "";
            document.getElementById('comm-content').value = "";
            alert("ê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
        } catch (e) {
            alert("ë“±ë¡ ì‹¤íŒ¨: ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
    };

    // ì‚­ì œ í•¨ìˆ˜
    window.delCommPost = async (id) => {
        if(confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            try {
                await deleteDoc(doc(db, "community", id));
            } catch (e) {
                alert("ì‚­ì œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
            }
        }
    };
</script>
    <section class="container" style="margin-top: 50px; margin-bottom: 20px;">
    <details style="background: #1a1a1a; border-radius: 12px; border: 1px solid #333; overflow: hidden; transition: 0.3s;">
        <summary style="padding: 18px; color: var(--accent); font-size: 15px; font-weight: bold; cursor: pointer; list-style: none; display: flex; justify-content: space-between; align-items: center; background: #222;">
            <span>ğŸ’¡ ì»¤ë®¤ë‹ˆí‹° ì´ìš© ê°€ì´ë“œ & FAQ</span>
            <span style="font-size: 12px; color: #666;">í¼ì³ë³´ê¸° â–¼</span>
        </summary>
        
        <div style="padding: 10px 20px 25px 20px; background: #151515;">
            <div style="margin-top: 15px; padding-bottom: 15px; border-bottom: 1px solid #222;">
                <strong style="display: block; color: #fff; margin-bottom: 8px; font-size: 14px;">â“ ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒì€ ì–´ë–»ê²Œ ì´ìš©í•˜ë‚˜ìš”?</strong>
                <p style="margin: 0; color: #888; font-size: 13px; line-height: 1.6;">
                    ì˜¤ë²„ì›Œì¹˜ í—ˆë¸Œ ì»¤ë®¤ë‹ˆí‹°ëŠ” ìš”ì›ë“¤ì˜ ììœ ë¡œìš´ ì†Œí†µì„ ìœ„í•œ ê³µê°„ì…ë‹ˆë‹¤. íŒŒí‹° í›„ê¸°, ê²Œì„ íŒ ê³µìœ , ì§ˆë¬¸ ë“± ì˜¤ë²„ì›Œì¹˜ì™€ ê´€ë ¨ëœ ì–´ë–¤ ì´ì•¼ê¸°ë“  í™˜ì˜í•©ë‹ˆë‹¤.
                </p>
            </div>
            <div style="margin-top: 15px; padding-bottom: 15px; border-bottom: 1px solid #222;">
                <strong style="display: block; color: #fff; margin-bottom: 8px; font-size: 14px;">ğŸš¨ ê²Œì‹œê¸€ ì‚­ì œ ê¸°ì¤€ì´ ìˆë‚˜ìš”?</strong>
                <p style="margin: 0; color: #888; font-size: 13px; line-height: 1.6;">
                    íƒ€ì¸ì— ëŒ€í•œ ë¹„ë°©, ìš•ì„¤, ë„ë°°, ê´‘ê³ ì„± ê²Œì‹œê¸€ì€ ê´€ë¦¬ìì— ì˜í•´ ì˜ˆê³  ì—†ì´ ì‚­ì œë  ìˆ˜ ìˆìœ¼ë©° ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¾Œì í•œ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•´ ë§¤ë„ˆë¥¼ ì§€ì¼œì£¼ì„¸ìš”.
                </p>
            </div>
            <div style="margin-top: 15px;">
                <strong style="display: block; color: #fff; margin-bottom: 8px; font-size: 14px;">âœ‰ï¸ ê´€ë¦¬ì ë¬¸ì˜</strong>
                <p style="margin: 0; color: #888; font-size: 13px; line-height: 1.6;">
                    ê²Œì‹œíŒ ì´ìš© ê´€ë ¨ ë²„ê·¸ ì œë³´ë‚˜ ë¹„ë§¤ë„ˆ ìœ ì € ì‹ ê³ ëŠ” ê´€ë¦¬ì ì´ë©”ì¼(jazzhjm@gmail.com)ë¡œ ë³´ë‚´ì£¼ì‹œë©´ í™•ì¸ í›„ ì¡°ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.
                </p>
            </div>
        </div>
    </details>
</section>

<footer style="text-align: center; padding: 40px 20px; color: #555; font-size: 12px; border-top: 1px solid #222; background: #000;">
    <div style="max-width: 800px; margin: 0 auto;">
        <div style="margin-bottom: 15px;">
            <a href="index.html" style="color: #888; text-decoration: none; margin-right: 15px;">íŒŒí‹°ì°¾ê¸°</a>
            <a href="commu.html" style="color: var(--accent); text-decoration: none; margin-right: 15px; font-weight: bold;">ì»¤ë®¤ë‹ˆí‹°</a>
            <a href="terms.html" style="color: #888; text-decoration: none; margin-right: 15px;">ì´ìš©ì•½ê´€</a>
            <a href="privacy.html" style="color: #888; text-decoration: none;">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a>
        </div>
        <p style="margin: 5px 0;">Â© 2026 Overwatch Hub (OWHUB). All rights reserved.</p>
        <p style="margin: 5px 0; font-size: 10px; color: #333;">Overwatch Hub isn't endorsed by Blizzard Entertainment and doesn't reflect the views or opinions of Blizzard Entertainment.</p>
    </div>
</footer>

</body>
</html>
