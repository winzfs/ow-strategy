<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overwatch Hub v3.0 - Professional</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&family=Orbitron:wght@900&display=swap" rel="stylesheet">

    <style>
        :root { --ow-orange: #ff9c00; --ow-dark: #0f1014; }
        body { font-family: 'Noto Sans KR', sans-serif; background: var(--ow-dark); color: white; margin: 0; overflow: hidden; }
        
        /* ì‚¬ì´ë“œë°” ê°€ë³€ êµ¬ì¡° */
        .sidebar { width: 280px; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); background: rgba(20, 22, 28, 0.98); border-right: 1px solid rgba(255,255,255,0.05); height: 100vh; position: fixed; z-index: 100; overflow: hidden; }
        .sidebar.collapsed { width: 80px; }
        .main-content { margin-left: 280px; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); height: 100vh; overflow-y: auto; background: radial-gradient(circle at top right, #1a1c23, #0f1014); }
        .main-content.expanded { margin-left: 80px; }

        /* ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ€ì¼ */
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; transition: 0.3s; }
        .glass:hover { border-color: var(--ow-orange); background: rgba(255, 255, 255, 0.06); }
        
        .nav-item { display: flex; align-items: center; gap: 1rem; padding: 0.875rem 1.25rem; border-radius: 0.75rem; font-weight: 700; transition: 0.3s; white-space: nowrap; color: #9ca3af; }
        .nav-item:hover { color: white; background: rgba(255,255,255,0.05); }
        .nav-item.active { background: rgba(255, 156, 0, 0.1); color: var(--ow-orange); box-shadow: inset -4px 0 0 var(--ow-orange); }

        .hidden-text { transition: opacity 0.3s; }
        .collapsed .hidden-text { opacity: 0; pointer-events: none; width: 0; }
        
        .view-section { display: none; animation: slideIn 0.4s ease-out; }
        .view-section.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }

        /* ì•Œë¦¼ ë°°ì§€ */
        .badge { position: absolute; top: 10px; right: 20px; width: 8px; height: 8px; background: var(--ow-orange); border-radius: 50%; box-shadow: 0 0 10px var(--ow-orange); }
        .collapsed .badge { right: 30px; }
    </style>
</head>
<body>

    <aside id="sidebar" class="sidebar flex flex-col p-4">
        <div class="flex items-center gap-4 mb-10 px-2 cursor-pointer" onclick="UI.toggleSidebar()">
            <div class="min-w-[40px] h-10 bg-[#ff9c00] rounded-xl flex items-center justify-center shadow-lg shadow-orange-500/20">
                <i class="fa-solid fa-bars text-black text-xl"></i>
            </div>
            <h1 class="hidden-text font-black tracking-tighter text-xl">OW <span class="text-[#ff9c00]">HUB</span></h1>
        </div>

        <nav class="flex-1 space-y-2">
            <button onclick="Router.go('matching')" class="nav-item active w-full" title="íŒŒí‹° ì°¾ê¸°">
                <i class="fa-solid fa-users-viewfinder text-xl min-w-[30px]"></i>
                <span class="hidden-text">íŒŒí‹° ë§¤ì¹­</span>
            </button>
            <button onclick="Router.go('community')" class="nav-item w-full" title="ì»¤ë®¤ë‹ˆí‹°">
                <i class="fa-solid fa-comments text-xl min-w-[30px]"></i>
                <span class="hidden-text">ì»¤ë®¤ë‹ˆí‹°</span>
            </button>
            <button onclick="UI.toggleNoti()" class="nav-item w-full relative" title="ì•Œë¦¼">
                <i class="fa-solid fa-bell text-xl min-w-[30px]"></i>
                <span class="hidden-text">ì•Œë¦¼ ë©”ì„¸ì§€</span>
                <div class="badge"></div>
            </button>
        </nav>

        <div class="mt-auto pt-4 border-t border-white/5">
            <div class="flex items-center gap-3 p-2 rounded-xl bg-white/5">
                <div class="min-w-[40px] h-10 rounded-full bg-orange-500 flex items-center justify-center font-black text-black">U</div>
                <div class="hidden-text overflow-hidden">
                    <p class="text-sm font-bold truncate">jazzhjm</p>
                    <p class="text-[10px] text-orange-500 font-bold">Admin</p>
                </div>
            </div>
        </div>
    </aside>

    <main id="main-content" class="main-content">
        <header class="sticky top-0 z-40 bg-[#0f1014]/80 backdrop-blur-xl border-b border-white/5 px-8 py-4 flex justify-between items-center">
            <div class="relative w-1/3 min-w-[200px]">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
                <input type="text" oninput="App.search(this.value)" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." class="w-full bg-white/5 border border-white/10 rounded-full py-2 px-12 outline-none focus:border-[#ff9c00]">
            </div>
            <button onclick="UI.openModal()" class="bg-[#ff9c00] text-black font-black px-6 py-2 rounded-full hover:scale-105 active:scale-95 transition">
                <i class="fa-solid fa-pen-to-square mr-2"></i> ê¸€ì“°ê¸°
            </button>
        </header>

        <section id="view-matching" class="view-section active p-8">
            <div class="flex justify-between items-end mb-8">
                <div>
                    <h2 class="text-4xl font-black italic mb-2 uppercase tracking-tighter">Squad Finder</h2>
                    <p id="party-stats" class="text-orange-500 text-xs font-bold tracking-widest">ë°ì´í„° ë¡œë”© ì¤‘...</p>
                </div>
                <div class="flex bg-white/5 p-1 rounded-xl border border-white/10" id="filter-btns">
                    <button onclick="App.filter('all')" class="px-6 py-2 rounded-lg text-xs font-black bg-[#ff9c00] text-black">ì „ì²´</button>
                    <button onclick="App.filter('íƒ±ì»¤')" class="px-6 py-2 rounded-lg text-xs font-black text-gray-400">íƒ±ì»¤</button>
                    <button onclick="App.filter('ë”œëŸ¬')" class="px-6 py-2 rounded-lg text-xs font-black text-gray-400">ë”œëŸ¬</button>
                    <button onclick="App.filter('ì§€ì›')" class="px-6 py-2 rounded-lg text-xs font-black text-gray-400">ì§€ì›</button>
                </div>
            </div>
            <div id="matching-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
        </section>

        <section id="view-community" class="view-section p-8">
            <h2 class="text-4xl font-black italic mb-10 uppercase tracking-tighter">Community Feed</h2>
            <div id="community-list" class="space-y-4"></div>
        </section>
    </main>

    <div id="modal-write" class="fixed inset-0 z-[200] hidden flex items-center justify-center p-6 bg-black/90 backdrop-blur-md">
        <div class="glass w-full max-w-xl p-8 bg-[#16171d] shadow-2xl">
            <div class="flex justify-between items-center mb-8">
                <div class="flex gap-4">
                    <button id="tab-p" onclick="UI.switchModalTab('p')" class="text-xl font-black border-b-2 border-[#ff9c00] text-[#ff9c00]">íŒŒí‹° ì°¾ê¸°</button>
                    <button id="tab-c" onclick="UI.switchModalTab('c')" class="text-xl font-black text-gray-500">ì»¤ë®¤ë‹ˆí‹°</button>
                </div>
                <button onclick="UI.closeModal()" class="text-gray-500 hover:text-white"><i class="fa-solid fa-xmark text-2xl"></i></button>
            </div>
            
            <form id="write-form" class="space-y-4">
                <input type="hidden" id="form-type" value="p">
                <div id="p-fields" class="grid grid-cols-2 gap-4">
                    <select id="f-role" class="bg-white/5 border border-white/10 rounded-xl p-4 outline-none focus:border-[#ff9c00]">
                        <option value="íƒ±ì»¤">ğŸ›¡ï¸ íƒ±ì»¤</option><option value="ë”œëŸ¬">âš”ï¸ ë”œëŸ¬</option><option value="ì§€ì›">ğŸ’‰ ì§€ì›</option>
                    </select>
                    <select id="f-tier" class="bg-white/5 border border-white/10 rounded-xl p-4 outline-none focus:border-[#ff9c00]">
                        <option>ë¸Œë¡ ì¦ˆ</option><option>ì‹¤ë²„</option><option>ê³¨ë“œ</option><option>í”Œë˜í‹°ë„˜</option><option>ë‹¤ì´ì•„ëª¬ë“œ</option><option>ë§ˆìŠ¤í„°</option><option>ê·¸ëœë“œë§ˆìŠ¤í„°</option>
                    </select>
                </div>
                <input type="text" id="f-tag" placeholder="BattleTag#1234 (ë˜ëŠ” ì œëª©)" class="w-full bg-white/5 border border-white/10 rounded-xl p-4 outline-none focus:border-[#ff9c00]">
                <textarea id="f-content" rows="5" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." class="w-full bg-white/5 border border-white/10 rounded-xl p-4 outline-none focus:border-[#ff9c00]"></textarea>
                <button type="submit" class="w-full bg-[#ff9c00] text-black font-black py-4 rounded-xl shadow-lg">ì‘ì„± ì™„ë£Œ</button>
            </form>
        </div>
    </div>

    <div id="noti-panel" class="fixed top-20 left-[290px] w-80 glass p-5 z-50 hidden shadow-2xl border-orange-500/20">
        <h4 class="font-black text-xs text-[#ff9c00] uppercase mb-4 tracking-tighter">Live Notifications</h4>
        <div class="space-y-3" id="noti-list">
            <div class="text-xs p-3 bg-white/5 rounded-lg border-l-2 border-orange-500">ìƒˆë¡œìš´ ê¸°ëŠ¥: ì‚¬ì´ë“œë°” ì ‘ê¸° ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // [Engineer] ì¸í”„ë¼ ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyCH...", // ê¸°ì¡´ API í‚¤
            authDomain: "owhub-655f2.firebaseapp.com",
            projectId: "owhub-655f2",
            storageBucket: "owhub-655f2.appspot.com",
            messagingSenderId: "367244907954",
            appId: "1:367244907954:web:866668702c2e557173e61f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // [Programmer] í•µì‹¬ ë¡œì§
        const App = {
            posts: [],
            community: [],
            currentView: 'matching',
            filterRole: 'all',
            searchKey: '',

            init() {
                this.listenData();
                this.setupForm();
            },

            listenData() {
                // íŒŒí‹° ë§¤ì¹­ ë°ì´í„°
                db.collection("posts").orderBy("timestamp", "desc").onSnapshot(snap => {
                    this.posts = snap.docs.map(doc => ({id: doc.id, ...doc.data()}));
                    this.renderMatching();
                });
                // ì»¤ë®¤ë‹ˆí‹° ë°ì´í„°
                db.collection("community").orderBy("timestamp", "desc").onSnapshot(snap => {
                    this.community = snap.docs.map(doc => ({id: doc.id, ...doc.data()}));
                    if(this.currentView === 'community') this.renderCommunity();
                });
            },

            setupForm() {
                document.getElementById('write-form').onsubmit = async (e) => {
                    e.preventDefault();
                    const type = document.getElementById('form-type').value;
                    const baseData = {
                        tag: document.getElementById('f-tag').value,
                        content: document.getElementById('f-content').value,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    };

                    if(type === 'p') {
                        await db.collection("posts").add({
                            ...baseData,
                            role: document.getElementById('f-role').value,
                            tier: document.getElementById('f-tier').value,
                            manner: 5.0
                        });
                    } else {
                        await db.collection("community").add(baseData);
                    }
                    
                    UI.closeModal();
                    e.target.reset();
                };
            },

            filter(role) {
                this.filterRole = role;
                this.renderMatching();
                UI.updateFilterUI(role);
            },

            search(val) {
                this.searchKey = val.toLowerCase();
                this.currentView === 'matching' ? this.renderMatching() : this.renderCommunity();
            },

            renderMatching() {
                const grid = document.getElementById('matching-grid');
                let list = this.posts.filter(p => this.filterRole === 'all' || p.role === this.filterRole);
                if(this.searchKey) list = list.filter(p => p.tag.toLowerCase().includes(this.searchKey) || p.content.toLowerCase().includes(this.searchKey));
                
                grid.innerHTML = list.map(p => `
                    <div class="glass p-6 group">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-[10px] font-black text-[#ff9c00] border border-[#ff9c00]/30 px-2 rounded">${p.role}</span>
                            <span class="text-[10px] font-bold text-gray-500 italic">${p.tier}</span>
                        </div>
                        <h4 class="text-xl font-black mb-1 group-hover:text-[#ff9c00] transition">${p.tag}</h4>
                        <p class="text-xs text-yellow-500 mb-4"><i class="fa-solid fa-star"></i> 5.0 MANNER</p>
                        <p class="text-sm text-gray-400 line-clamp-2 mb-6 h-10">${p.content || 'ìŠ¹ë¦¬ë¥¼ ìœ„í•´!'}</p>
                        <button class="w-full py-3 bg-white/5 rounded-xl text-xs font-black hover:bg-[#ff9c00] hover:text-black transition">ì‹ ì²­í•˜ê¸°</button>
                    </div>
                `).join('');
                document.getElementById('party-stats').innerText = `${list.length}ëª…ì˜ ìš”ì› ëŒ€ê¸° ì¤‘`;
            },

            renderCommunity() {
                const listEl = document.getElementById('community-list');
                let list = this.community;
                if(this.searchKey) list = list.filter(c => c.tag.toLowerCase().includes(this.searchKey) || c.content.toLowerCase().includes(this.searchKey));

                listEl.innerHTML = list.map(c => `
                    <div class="glass p-6 hover:translate-x-2 transition cursor-pointer">
                        <h3 class="text-lg font-black mb-1">${c.tag}</h3>
                        <p class="text-sm text-gray-400 mb-3">${c.content}</p>
                        <div class="flex items-center gap-4 text-[10px] font-bold text-gray-500 uppercase">
                            <span><i class="fa-solid fa-user mr-1"></i> Player</span>
                            <span><i class="fa-solid fa-clock mr-1"></i> Just Now</span>
                        </div>
                    </div>
                `).join('');
            }
        };

        // [Designer] ì¸í„°í˜ì´ìŠ¤ í•¸ë“¤ëŸ¬
        const UI = {
            toggleSidebar() {
                document.getElementById('sidebar').classList.toggle('collapsed');
                document.getElementById('main-content').classList.toggle('expanded');
                const panel = document.getElementById('noti-panel');
                panel.style.left = document.getElementById('sidebar').classList.contains('collapsed') ? '90px' : '290px';
            },

            openModal() { document.getElementById('modal-write').classList.remove('hidden'); },
            closeModal() { document.getElementById('modal-write').classList.add('hidden'); },

            switchModalTab(type) {
                document.getElementById('form-type').value = type;
                document.getElementById('p-fields').style.display = type === 'p' ? 'grid' : 'none';
                document.getElementById('tab-p').className = type === 'p' ? "text-xl font-black border-b-2 border-[#ff9c00] text-[#ff9c00]" : "text-xl font-black text-gray-500";
                document.getElementById('tab-c').className = type === 'c' ? "text-xl font-black border-b-2 border-[#ff9c00] text-[#ff9c00]" : "text-xl font-black text-gray-500";
            },

            toggleNoti() { document.getElementById('noti-panel').classList.toggle('hidden'); },

            updateFilterUI(role) {
                document.querySelectorAll('#filter-btns button').forEach(b => {
                    b.classList = "px-6 py-2 rounded-lg text-xs font-black text-gray-400";
                    if(b.innerText.includes(role) || (role==='all' && b.innerText==='ì „ì²´')) {
                        b.classList = "px-6 py-2 rounded-lg text-xs font-black bg-[#ff9c00] text-black shadow-lg shadow-orange-500/30";
                    }
                });
            }
        };

        const Router = {
            go(view) {
                App.currentView = view;
                document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
                document.getElementById(`view-${view}`).classList.add('active');
                
                document.querySelectorAll('.nav-item').forEach(n => {
                    n.classList.remove('active');
                    if(n.title.includes(view === 'matching' ? 'íŒŒí‹°' : 'ì»¤ë®¤ë‹ˆí‹°')) n.classList.add('active');
                });
                
                if(view === 'community') App.renderCommunity();
                else App.renderMatching();
            }
        };

        App.init();
    </script>
</body>
</html>
