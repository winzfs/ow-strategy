<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OW2 TIER MAKER</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --ow-orange: #f99e1a;
            --bg-dark: #0b0e12;
            --panel: #1e232d;
            --tier-s: #ff7f7f; --tier-a: #ffbf7f; --tier-b: #ffff7f; --tier-c: #7fff7f; --tier-d: #7fbfff;
        }

        body {
            background: var(--bg-dark); color: white; font-family: 'Malgun Gothic', sans-serif;
            margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center;
            overflow-x: hidden; -webkit-tap-highlight-color: transparent;
        }

        header { width: 100%; max-width: 900px; text-align: left; padding: 10px; border-bottom: 2px solid var(--ow-orange); margin-bottom: 15px; }
        header h1 { margin: 0; font-size: 1.5rem; color: var(--ow-orange); text-transform: uppercase; }

        /* 탭 메뉴 */
        .tab-menu { display: flex; width: 100%; max-width: 900px; gap: 4px; margin-bottom: 10px; }
        .tab-btn {
            flex: 1; padding: 12px 5px; border: none; background: #252a34; color: #888;
            font-weight: bold; cursor: pointer; border-radius: 4px 4px 0 0;
        }
        .tab-btn.active { background: var(--ow-orange); color: black; }

        /* 티어표 영역 */
        #capture-zone { width: 100%; max-width: 900px; background: var(--bg-dark); padding: 5px; box-sizing: border-box; }
        .tier-board { display: flex; flex-direction: column; gap: 5px; width: 100%; }
        .tier-row { display: flex; background: var(--panel); min-height: 80px; border-radius: 4px; position: relative; }
        
        .tier-label {
            width: 60px; min-width: 60px; display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; font-weight: 900; color: #000; border-radius: 4px 0 0 4px;
        }

        .dropzone { flex-grow: 1; display: flex; flex-wrap: wrap; padding: 8px; gap: 6px; align-content: flex-start; min-height: 60px; }

        /* 영웅 아이콘 */
        .hero {
            width: 50px; height: 62px; background: #2a2f3b; border: 1.5px solid #4a5162;
            position: relative; background-size: cover; background-position: center;
            border-radius: 3px; touch-action: none; user-select: none;
        }
        .hero span { position: absolute; bottom: 0; font-size: 8px; background: rgba(0,0,0,0.8); width: 100%; text-align: center; padding: 1px 0; }
        
        /* 배치된 영웅 클릭 시 삭제 버튼 */
        .del-btn {
            position: absolute; top: -8px; right: -8px; width: 20px; height: 20px;
            background: #ff4444; color: white; border-radius: 50%; display: none;
            align-items: center; justify-content: center; font-size: 12px; font-weight: bold; border: 1.5px solid white; z-index: 30;
        }
        .tier-row .hero.selected .del-btn { display: flex; }

        /* 로스터 영역 */
        .roster-wrap { width: 100%; max-width: 900px; margin-top: 20px; background: #161b22; padding: 15px; border-radius: 8px; box-sizing: border-box; }
        .roster-title { font-size: 0.9rem; margin-bottom: 10px; color: #aaa; border-left: 3px solid var(--ow-orange); padding-left: 8px; }
        .pool-view { display: none; flex-wrap: wrap; gap: 8px; justify-content: flex-start; }
        .pool-view.active { display: flex; }

        /* 컨트롤 패널 */
        .controls { width: 100%; max-width: 900px; display: flex; flex-wrap: wrap; gap: 10px; margin: 15px 0; padding: 0 5px; }
        .controls input, .controls button { padding: 10px; border-radius: 4px; border: 1px solid #333; }
        .btn-save { background: var(--ow-orange); color: black; font-weight: bold; flex-grow: 1; border: none !important; }

        /* 티어 줄 삭제 버튼 */
        .row-del-btn {
            position: absolute; left: -30px; top: 50%; transform: translateY(-50%);
            background: none; border: none; color: #444; font-size: 1.5rem; cursor: pointer;
        }

        @media (max-width: 600px) {
            .row-del-btn { left: 2px; color: rgba(255,255,255,0.5); z-index: 10; }
            .tier-label { width: 50px; min-width: 50px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>

    <header>
        <h1>Overwatch 2 Tier Maker</h1>
    </header>

    <div class="tab-menu">
        <button class="tab-btn active" onclick="changeTab('tank')">TANK</button>
        <button class="tab-btn" onclick="changeTab('damage')">DPS</button>
        <button class="tab-btn" onclick="changeTab('support')">SUP</button>
    </div>

    <div id="capture-zone">
        <div id="current-board-title" style="padding: 10px; font-weight: bold; color: var(--ow-orange);">돌격(TANK) 리스트</div>
        <div class="tier-board" id="main-board">
            <div class="tier-row"><button class="row-del-btn" onclick="this.parentElement.remove()">×</button><div class="tier-label" style="background:var(--tier-s)">S</div><div class="dropzone"></div></div>
            <div class="tier-row"><button class="row-del-btn" onclick="this.parentElement.remove()">×</button><div class="tier-label" style="background:var(--tier-a)">A</div><div class="dropzone"></div></div>
            <div class="tier-row"><button class="row-del-btn" onclick="this.parentElement.remove()">×</button><div class="tier-label" style="background:var(--tier-b)">B</div><div class="dropzone"></div></div>
            <div class="tier-row"><button class="row-del-btn" onclick="this.parentElement.remove()">×</button><div class="tier-label" style="background:var(--tier-c)">C</div><div class="dropzone"></div></div>
            <div class="tier-row"><button class="row-del-btn" onclick="this.parentElement.remove()">×</button><div class="tier-label" style="background:var(--tier-d)">D</div><div class="dropzone"></div></div>
        </div>
    </div>

    <div class="controls">
        <input type="text" id="tier-name" placeholder="티어명" style="width:70px;">
        <input type="color" id="tier-color" value="#666666" style="width:40px; padding:0;">
        <button onclick="addTier()">티어 추가</button>
        <button class="btn-save" onclick="saveImage()">이미지 저장</button>
    </div>

    <div class="roster-wrap">
        <div class="roster-title">HERO ROSTER</div>
        <div id="pool-tank" class="pool-view active dropzone"></div>
        <div id="pool-damage" class="pool-view dropzone"></div>
        <div id="pool-support" class="pool-view dropzone"></div>
    </div>

<script>
    const IMG_URL = "images/";
    const heroList = {
        tank: [{id:'dva', n:'D.Va'}, {id:'doomfist', n:'둠피'}, {id:'junkerqueen', n:'정커퀸'}, {id:'orisa', n:'오리사'}, {id:'ramattra', n:'라마트라'}, {id:'reinhardt', n:'라인'}, {id:'roadhog', n:'로드'}, {id:'sigma', n:'시그마'}, {id:'winston', n:'윈스턴'}, {id:'wreckingball', n:'레킹볼'}, {id:'zarya', n:'자리야'}, {id:'mauga', n:'마우가'}],
        damage: [{id:'ashe', n:'애쉬'}, {id:'bastion', n:'바스티온'}, {id:'cassidy', n:'캐시디'}, {id:'echo', n:'에코'}, {id:'genji', n:'겐지'}, {id:'hanzo', n:'한조'}, {id:'junkrat', n:'정크랫'}, {id:'mei', n:'메이'}, {id:'pharah', n:'파라'}, {id:'reaper', n:'리퍼'}, {id:'sojourn', n:'소전'}, {id:'soldier76', n:'솔저'}, {id:'sombra', n:'솜브라'}, {id:'symmetra', n:'시메'}, {id:'torbjorn', n:'토비'}, {id:'tracer', n:'트레'}, {id:'widowmaker', n:'위도'}, {id:'venture', n:'벤처'}],
        support: [{id:'ana', n:'아나'}, {id:'baptiste', n:'바티'}, {id:'brigitte', n:'브리'}, {id:'illari', n:'일리아리'}, {id:'kiriko', n:'키리코'}, {id:'lifeweaver', n:'라위'}, {id:'lucio', n:'루시우'}, {id:'mercy', n:'메르시'}, {id:'moira', n:'모이라'}, {id:'zenyatta', n:'젠야타'}, {id:'juno', n:'유노'}]
    };

    let draggedItem = null;

    function createHeroes() {
        Object.keys(heroList).forEach(role => {
            const container = document.getElementById(`pool-${role}`);
            heroList[role].forEach(h => {
                const el = document.createElement('div');
                el.className = 'hero';
                el.style.backgroundImage = `url('${IMG_URL}${h.id}.png')`;
                el.dataset.role = role;
                el.innerHTML = `<span>${h.n}</span><div class="del-btn">×</div>`;
                
                // 클릭 시 선택(삭제버튼 노출용)
                el.onclick = (e) => {
                    e.stopPropagation();
                    document.querySelectorAll('.hero').forEach(x => x.classList.remove('selected'));
                    el.classList.add('selected');
                };

                // 삭제 버튼 클릭 시 원래 로스터로 복구
                el.querySelector('.del-btn').onclick = (e) => {
                    e.stopPropagation();
                    document.getElementById(`pool-${el.dataset.role}`).appendChild(el);
                    el.classList.remove('selected');
                };

                // 모바일 드래그 지원
                el.ontouchstart = (e) => { draggedItem = el; el.classList.add('dragging'); };
                el.ontouchmove = (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    el.style.position = 'fixed';
                    el.style.left = touch.clientX - 25 + 'px';
                    el.style.top = touch.clientY - 30 + 'px';
                    el.style.zIndex = 1000;
                };
                el.ontouchend = (e) => {
                    el.classList.remove('dragging');
                    el.style.position = 'static';
                    const touch = e.changedTouches[0];
                    const target = document.elementFromPoint(touch.clientX, touch.clientY);
                    const zone = target?.closest('.dropzone');
                    if(zone) zone.appendChild(el);
                    draggedItem = null;
                };
                container.appendChild(el);
            });
        });
    }

    function changeTab(role) {
        // 탭 버튼 활성화
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        
        // 로스터 풀 교체
        document.querySelectorAll('.pool-view').forEach(p => p.classList.remove('active'));
        document.getElementById(`pool-${role}`).classList.add('active');
        
        // 제목 변경
        const names = {tank:'돌격(TANK)', damage:'공격(DPS)', support:'지원(SUP)'};
        document.getElementById('current-board-title').innerText = `${names[role]} 리스트`;
    }

    function addTier() {
        const name = document.getElementById('tier-name').value || 'N';
        const color = document.getElementById('tier-color').value;
        const row = document.createElement('div');
        row.className = 'tier-row';
        row.innerHTML = `<button class="row-del-btn" onclick="this.parentElement.remove()">×</button><div class="tier-label" style="background:${color}">${name}</div><div class="dropzone"></div>`;
        document.getElementById('main-board').appendChild(row);
    }

    function saveImage() {
        document.querySelectorAll('.hero').forEach(h => h.classList.remove('selected'));
        html2canvas(document.getElementById('capture-zone'), {backgroundColor:'#0b0e12'}).then(canvas => {
            const a = document.createElement('a');
            a.href = canvas.toDataURL();
            a.download = 'tier-list.png';
            a.click();
        });
    }

    // 바탕 클릭 시 선택 해제
    document.addEventListener('click', () => document.querySelectorAll('.hero').forEach(h => h.classList.remove('selected')));

    createHeroes();
</script>
</body>
</html>
