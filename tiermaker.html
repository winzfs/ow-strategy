<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OW2 í†µí•© ë¡œìŠ¤í„° í‹°ì–´ë©”ì´ì»¤</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --ow-orange: #f99e1a;
            --ow-blue: #00aeff;
            --bg-dark: #080a0e;
            --panel: #1a1e26;
            --tier-s: #ff7f7f; --tier-a: #ffbf7f; --tier-b: #ffff7f; --tier-c: #7fff7f; --tier-d: #7fbfff;
        }

        body {
            background: var(--bg-dark); color: white; font-family: 'Malgun Gothic', sans-serif;
            margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center;
        }

        header { width: 100%; max-width: 1000px; margin-bottom: 20px; border-left: 6px solid var(--ow-orange); padding-left: 15px; }

        /* í‹°ì–´ êµ¬ì—­ (ìº¡ì²˜ ëŒ€ìƒ) */
        .capture-area { 
            width: 100%; max-width: 1000px; padding: 25px; 
            background: var(--bg-dark); border: 2px solid #333; border-radius: 8px;
        }
        .tier-board { display: flex; flex-direction: column; gap: 10px; }
        .tier-row { display: flex; background: var(--panel); border-radius: 4px; overflow: hidden; min-height: 90px; }
        .tier-label {
            width: 80px; min-width: 80px; display: flex; align-items: center; justify-content: center;
            font-size: 2rem; font-weight: 900; color: #000; clip-path: polygon(0 0, 100% 0, 85% 100%, 0% 100%);
        }
        .dropzone { flex-grow: 1; display: flex; flex-wrap: wrap; padding: 10px; gap: 8px; align-content: flex-start; }

        /* ì˜ì›… ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .hero {
            width: 55px; height: 70px; background: #2a2f3b; border: 2px solid #4a5162;
            cursor: grab; position: relative; background-size: cover; background-position: center;
            transition: transform 0.1s;
        }
        .hero span { position: absolute; bottom: 0; font-size: 8px; background: rgba(0,0,0,0.8); width: 100%; text-align: center; pointer-events: none; }
        .del-btn {
            position: absolute; top: -8px; right: -8px; width: 18px; height: 18px;
            background: red; color: white; border-radius: 50%; display: none;
            align-items: center; justify-content: center; font-size: 10px; border: 2px solid white; z-index: 5;
        }
        .hero.selected .del-btn { display: flex; }

        /* í¬ì§€ì…˜ë³„ ë¡œìŠ¤í„° êµ¬ì—­ */
        .roster-container { width: 100%; max-width: 1000px; margin-top: 30px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
        .roster-group { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 8px; border-top: 3px solid #444; }
        .group-tank { border-color: #555; }
        .group-damage { border-color: #aa4444; }
        .group-support { border-color: #44aa44; }
        .roster-title { font-size: 0.9rem; font-weight: bold; margin-bottom: 10px; text-align: center; color: #aaa; text-transform: uppercase; }

        /* í•˜ë‹¨ ì»¨íŠ¸ë¡¤ */
        .controls { width: 100%; max-width: 1000px; margin-top: 20px; display: flex; gap: 10px; align-items: center; }
        .btn { padding: 12px 24px; border: none; cursor: pointer; font-weight: bold; clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%); }
        .btn-add { background: #333; color: white; }
        .btn-save { background: var(--ow-orange); color: black; flex-grow: 1; font-size: 1.1rem; }

        @media (max-width: 800px) { .roster-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <header>
        <h1>ì˜¤ë²„ì›Œì¹˜ 2 í‹°ì–´ ë¦¬ìŠ¤íŠ¸ ë©”ì´ì»¤</h1>
    </header>

    <div id="capture-zone" class="capture-area">
        <div class="tier-board" id="tier-board">
            <div class="tier-row"><div class="tier-label" style="background:var(--tier-s)">S</div><div class="dropzone"></div></div>
            <div class="tier-row"><div class="tier-label" style="background:var(--tier-a)">A</div><div class="dropzone"></div></div>
            <div class="tier-row"><div class="tier-label" style="background:var(--tier-b)">B</div><div class="dropzone"></div></div>
            <div class="tier-row"><div class="tier-label" style="background:var(--tier-c)">C</div><div class="dropzone"></div></div>
            <div class="tier-row"><div class="tier-label" style="background:var(--tier-d)">D</div><div class="dropzone"></div></div>
        </div>
    </div>

    <div class="controls">
        <input type="text" id="new-tier-name" placeholder="í‹°ì–´ëª…" style="padding:10px; width:80px; background:#222; border:1px solid #444; color:white;">
        <input type="color" id="new-tier-color" value="#666666">
        <button class="btn btn-add" onclick="createNewTier()">í‹°ì–´ ì¶”ê°€</button>
        <button class="btn btn-save" onclick="downloadImage()">í‹°ì–´í‘œ ì´ë¯¸ì§€ ì €ì¥ (.PNG)</button>
    </div>

    <div class="roster-container">
        <div class="roster-group group-tank">
            <div class="roster-title">ğŸ›¡ï¸ ëŒê²© (TANK)</div>
            <div id="pool-tank" class="dropzone"></div>
        </div>
        <div class="roster-group group-damage">
            <div class="roster-title">âš”ï¸ ê³µê²© (DAMAGE)</div>
            <div id="pool-damage" class="dropzone"></div>
        </div>
        <div class="roster-group group-support">
            <div class="roster-title">ğŸ’‰ ì§€ì› (SUPPORT)</div>
            <div id="pool-support" class="dropzone"></div>
        </div>
    </div>

<script>
    const IMG_BASE_URL = "images/"; // ì„œë²„ ì´ë¯¸ì§€ ê²½ë¡œ
    const heroData = {
        tank: [
            {id:'dva', name:'D.Va'}, {id:'doomfist', name:'ë‘ í”¼ìŠ¤íŠ¸'}, {id:'junkerqueen', name:'ì •ì»¤í€¸'}, {id:'orisa', name:'ì˜¤ë¦¬ì‚¬'}, 
            {id:'ramattra', name:'ë¼ë§ˆíŠ¸ë¼'}, {id:'reinhardt', name:'ë¼ì¸í•˜ë¥´íŠ¸'}, {id:'roadhog', name:'ë¡œë“œí˜¸ê·¸'}, 
            {id:'sigma', name:'ì‹œê·¸ë§ˆ'}, {id:'winston', name:'ìœˆìŠ¤í„´'}, {id:'wreckingball', name:'ë ˆí‚¹ë³¼'}, {id:'zarya', name:'ìë¦¬ì•¼'}, {id:'mauga', name:'ë§ˆìš°ê°€'}
        ],
        damage: [
            {id:'ashe', name:'ì• ì‰¬'}, {id:'bastion', name:'ë°”ìŠ¤í‹°ì˜¨'}, {id:'cassidy', name:'ìºì‹œë””'}, {id:'echo', name:'ì—ì½”'}, 
            {id:'genji', name:'ê²ì§€'}, {id:'hanzo', name:'í•œì¡°'}, {id:'junkrat', name:'ì •í¬ë«'}, {id:'mei', name:'ë©”ì´'}, 
            {id:'pharah', name:'íŒŒë¼'}, {id:'reaper', name:'ë¦¬í¼'}, {id:'sojourn', name:'ì†Œì „'}, {id:'soldier76', name:'ì†”ì €76'}, 
            {id:'sombra', name:'ì†œë¸Œë¼'}, {id:'symmetra', name:'ì‹œë©”íŠ¸ë¼'}, {id:'torbjorn', name:'í† ë¦¬ë¹„ì˜¨'}, {id:'tracer', name:'íŠ¸ë ˆì´ì„œ'}, 
            {id:'widowmaker', name:'ìœ„ë„ìš°ë©”ì´ì»¤'}, {id:'venture', name:'ë²¤ì²˜'}
        ],
        support: [
            {id:'ana', name:'ì•„ë‚˜'}, {id:'baptiste', name:'ë°”í‹°ìŠ¤íŠ¸'}, {id:'brigitte', name:'ë¸Œë¦¬ê¸°í…Œ'}, {id:'illari', name:'ì¼ë¦¬ì•„ë¦¬'}, 
            {id:'kiriko', name:'í‚¤ë¦¬ì½”'}, {id:'lifeweaver', name:'ë¼ì´í”„ìœ„ë²„'}, {id:'lucio', name:'ë£¨ì‹œìš°'}, {id:'mercy', name:'ë©”ë¥´ì‹œ'}, 
            {id:'moira', name:'ëª¨ì´ë¼'}, {id:'zenyatta', name:'ì  ì•¼íƒ€'}, {id:'juno', name:'ìœ ë…¸'}
        ]
    };

    let dragItem = null;

    function init() {
        Object.keys(heroData).forEach(role => {
            const pool = document.getElementById(`pool-${role}`);
            heroData[role].forEach(h => {
                const div = document.createElement('div');
                div.className = 'hero';
                div.draggable = true;
                div.style.backgroundImage = `url('${IMG_BASE_URL}${h.id}.png')`;
                div.dataset.role = role; // ì›ë˜ í¬ì§€ì…˜ ì •ë³´ ì €ì¥
                div.innerHTML = `<span>${h.name}</span><div class="del-btn">Ã—</div>`;
                
                div.addEventListener('click', (e) => {
                    e.stopPropagation();
                    document.querySelectorAll('.hero').forEach(el => el.classList.remove('selected'));
                    div.classList.toggle('selected');
                });

                div.querySelector('.del-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    document.getElementById(`pool-${div.dataset.role}`).appendChild(div);
                    div.classList.remove('selected');
                });

                div.addEventListener('dragstart', () => { dragItem = div; div.classList.add('dragging'); });
                div.addEventListener('dragend', () => { dragItem = null; div.classList.remove('dragging'); });
                pool.appendChild(div);
            });
        });
        document.querySelectorAll('.dropzone').forEach(setupDropzone);
    }

    function setupDropzone(zone) {
        zone.addEventListener('dragover', (e) => e.preventDefault());
        zone.addEventListener('drop', () => { if(dragItem) { zone.appendChild(dragItem); dragItem.classList.remove('selected'); } });
    }

    function createNewTier() {
        const name = document.getElementById('new-tier-name').value || "NEW";
        const color = document.getElementById('new-tier-color').value;
        const row = document.createElement('div');
        row.className = 'tier-row';
        row.innerHTML = `<div class="tier-label" style="background:${color}">${name}</div><div class="dropzone"></div>`;
        document.getElementById('tier-board').appendChild(row);
        setupDropzone(row.querySelector('.dropzone'));
    }

    function downloadImage() {
        const zone = document.getElementById('capture-zone');
        // ê²°ê³¼ ì´ë¯¸ì§€ ìƒì„± ì „ ì„ íƒ íš¨ê³¼ í•´ì œ
        document.querySelectorAll('.hero').forEach(h => h.classList.remove('selected'));
        
        html2canvas(zone, { 
            backgroundColor: '#080a0e',
            useCORS: true // ì„œë²„ ì´ë¯¸ì§€ í—ˆìš© ì„¤ì •
        }).then(canvas => {
            const link = document.createElement('a');
            link.download = `ow2-tier-${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    init();
    document.addEventListener('click', () => document.querySelectorAll('.hero').forEach(h => h.classList.remove('selected')));
</script>
</body>
</html>
